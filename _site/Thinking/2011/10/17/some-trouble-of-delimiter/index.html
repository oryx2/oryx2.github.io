<!DOCTYPE html>
 
<html>
  <head>
    
      <title>分隔符问题 &bull;WebSite </title>
    
    <link rel="stylesheet" href="/stylesheets/reset.css" type="text/css" media="all" />
    <link rel="stylesheet" href="/stylesheets/screen.css" type="text/css" media="all" />
    <link rel="stylesheet" href="/stylesheets/GrungeEra.css" type="text/css" media="all" />
    <link rel="stylesheet" href="/stylesheets/style.css" type="text/css" media="all" />
    <link rel="stylesheet" href="/stylesheets/syntax.css" type="text/css" media="all" />
    <script src="/javascripts/jquery.js" type="text/javascript"></script>
    <script src="/javascripts/soundmanager2.js" type="text/javascript"></script>
    <script type="text/javascript">
      //<![CDATA[
        soundManager.url = '/swf/'; 
        soundManager.debugMode = false
      //]]>
    </script>
    <link rel="shortcut icon" href="/images/favicon.ico" />
    <link rel="alternate" type="application/atom+xml" title="Blueness - articles" href="http://sizhujay.me/articles.xml">
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
  </head>
  <body>
    <div id="wrap">
      <div id="header">
        <a name="top"></a>
        <div id="logo"><a href="/" title="">Blueness</a></div>
        <p id="intro">
          Personal site of Blueness
        </p>
      </div>
      <div id="content-outer" class="clear">
        <div id="content-wrap">
          <div class="content">
            <div class="post">
              <h1>
分隔符问题 
<div id="post-nav">

  <span class="page-nav-item prev">
    <a rel="prev" href="/2011/09/29/write-blog-from-notepad/" 
        title="Blogging Like a Hacker"
    >«</a>
  </span>
 


    <span class="page-nav-item next">
      <a rel="next" href="/Thinking/2011/10/17/stop-your-step-to-thinking/" 
          title="偶尔停下匆忙的脚步，驻足思考"
      >»</a>
    </span>
  
</div>
</h1>
<p class="post-info">Posted on 17 October 2011 </p>
<p>项目中经常使用竖线“|”作为分隔符，一直以来没有出现问题，像下面这样：</p>

<p>a|b|c|d|啊|哦|额</p>

<p>用的也比较多，比较简洁吧。 但今天再次使用这种方式时却遇到了问题，解析出错了，客户姓名里包含一个繁体中文“韡”(这个念wěi)。编码方式为gbk，最初以为gbk字库里没有该繁体字，google一下发现有，哎，失败。继续，后仔细看解析后的结果，发现虽然“韡”解为乱码，但之后的一项正确解析了，只是最后的数据少了一项，就感觉“韡”中间包含了一个竖线似的。没办法，反编译看看吧，发现项目是拿字节去比较，然后截取的，于是怀疑“韡”中的某位字节与“|”线的字节相等，测试一下果然，“韡” gbk下的字节为ED7C,而竖线的字节为7C,ou出问题了。 将编码改为UTF-8,解决之。 过后我在想，UTF-8编码难道不会出现这种情况，遂又查询了一下UTF-8编码方式，如下:</p>

<p>Unicode符号范围 | UTF-8编码方式 (十六进制) | （二进制） &#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8211;+&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212; 0000 0000-0000 007F | 0xxxxxxx</p>

<p>0000 0080-0000 07FF | 110xxxxx 10xxxxxx</p>

<p>0000 0800-0000 FFFF | 1110xxxx 10xxxxxx 10xxxxxx</p>

<p>0001 0000-0010 FFFF | 11110xxx 10xxxxxx 10xxxxxx 10xxxxxx</p>

<p>汉字在第二行或第三行，竖线在第一行，007C，可以看出汉字的字节数组中不会存在第一行中的字节，故不会出现上述问题。</p>

<p>其实还有疑问，分隔时为什么按字节截取，而不是按字符截取，哎，以后再想吧。</p>


            </div>
          </div>
        </div>
		 </div>
      <div id="footer-outer" class="clear"><div id="footer-wrap">
        <div class="content">	
          <div class="columns">
            <div class="col">
              <h3>About</h3>
                <p>
                  <a href="mailto:blueness.d@gmail.com" title="Blueness"><img  src="/images/gravatar.jpg"  alt="Blueness" class="float-left"></a>
                  
                <p class='copyright'>
                  <a href="http://sizhujay.me/articles.xml" title="Subscribe to feed"><img src="/images/feed.gif" style="border:none;padding:0;position:relative;top:3px;" /></a>
                  Powered by <a href="http://jekyllrb.com/" target="_blank">Jekyll</a>, styled with <a href="http://www.styleshout.com/templates/preview/GrungeEra11/index.html" target="_blank">GrungeEra</a>.
                </p>
              </div>	
              <div class="col">
                <h3>Search</h3>
                <form id="quick-search" action="http://www.google.com/search" method="get">
                  <p>
                    <label for="qsearch">Search:</label>
                    <input class="tbox" id="qsearch" type="text" name="q" value="Search..." title="Start typing and hit ENTER" onclick="this.value=''">
                    <input name="sitesearch" type="hidden" value="rors.org" /> 
                    <input class="btn" alt="Search" type="image" name="searchsubmit" title="Search" src="/images/search.gif">
                  </p>
                </form>	
                
                <h3>Archive </h3>
                <div class="footer-list">
                  <ul>
                   
                    <li>
                      <a href="/Thinking/2011/10/17/stop-your-step-to-thinking/">
                        偶尔停下匆忙的脚步，驻足思考
                      </a>
                    </li>
                    
                    <li>
                      <a href="/Thinking/2011/10/17/some-trouble-of-delimiter/">
                        分隔符问题
                      </a>
                    </li>
                    
                    <li>
                      <a href="/2011/09/29/write-blog-from-notepad/">
                        Blogging Like a Hacker
                      </a>
                    </li>
                    
                  </ul>
                </div>
              </div>

            <!-- columns ends -->	
            </div>

          </div>

        <!-- footer ends -->
        </div>
        </div>
    <div/>
    <script type="text/javascript">
    var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
    document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
    </script>
    <script type="text/javascript">
    var pageTracker = _gat._getTracker("UA-1192097-4");
    pageTracker._initData();
    pageTracker._trackPageview();
    </script>
  </body>
</html>